{"version":3,"file":"index.js","sources":["../../../../../node_modules/@savage181855/utils/dist/index.js","../../../../../src/libs/tips.ts","../../../../../src/libs/utils.ts","../../../../../src/libs/dep.ts","../../../../../src/libs/proxyFunc.ts","../../../../../src/libs/createStore.ts","../../../../../src/libs/defineStore.ts"],"sourcesContent":["'use strict';\n\n// a[3].b -> a.3.b -> [a, 3, b]\r\n/** lodash get方法 */\r\nfunction getType(o) {\r\n    return Object.prototype.toString.call(o);\r\n}\r\nfunction get(data, path) {\r\n    var paths = path\r\n        .replace(/\\[(\\w+)\\]/g, \".$1\")\r\n        .replace(/\\[\"(\\w+)\"\\]/g, \".$1\")\r\n        .replace(/\\['(\\w+)'\\]/g, \".$1\")\r\n        .split(\".\");\r\n    return paths.reduce(function (x, y) { return x === null || x === void 0 ? void 0 : x[y]; }, data);\r\n}\r\nfunction compare(o1, o2, type) {\r\n    if (o1 === o2)\r\n        return true;\r\n    // 如果基本类型不相等或者不是引用类型，并且不是对象就不用执行了\r\n    if (typeof o1 !== \"object\" ||\r\n        o1 === null ||\r\n        typeof o2 !== \"object\" ||\r\n        o2 === null) {\r\n        return false;\r\n    }\r\n    var len1 = Object.keys(o1).length;\r\n    var len2 = Object.keys(o2).length;\r\n    if (len1 !== len2)\r\n        return false;\r\n    for (var _i = 0, _a = Object.keys(o1); _i < _a.length; _i++) {\r\n        var key = _a[_i];\r\n        if (type === \"shallow\") {\r\n            if (o1[key] !== o2[key])\r\n                return false;\r\n        }\r\n        if (type === \"deep\") {\r\n            var result = compare(o1[key], o2[key], \"deep\");\r\n            if (!result)\r\n                return result;\r\n        }\r\n    }\r\n    return true;\r\n}\r\n/** 对象浅比较，只比较第一层数据 */\r\nfunction isSameShallow(o1, o2) {\r\n    return compare(o1, o2, \"shallow\");\r\n}\r\n/** 对象深比较，比较所有层数据， 深比较主要的点在于，Object或Array实例的每一个属性，基本类型或者特殊构造器类型是否相同 */\r\nfunction isSameDeep(o1, o2) {\r\n    return compare(o1, o2, \"deep\");\r\n}\r\nvar dataType = {\r\n    object: \"[object Object]\",\r\n    array: \"[object Array]\",\r\n};\r\nfunction clone(o, type) {\r\n    var objType = getType(o);\r\n    if (objType === dataType.object) {\r\n        var obj_1 = {};\r\n        Object.keys(o).forEach(function (k) {\r\n            obj_1[k] =\r\n                type === \"shallow\"\r\n                    ? o[k]\r\n                    : clone(o[k], \"deep\");\r\n        });\r\n        return obj_1;\r\n    }\r\n    if (objType === dataType.array) {\r\n        return o.map(function (item) {\r\n            return type === \"shallow\" ? item : clone(item, \"deep\");\r\n        });\r\n    }\r\n    return o;\r\n}\r\n/** 浅拷贝，只拷贝第一层数据 */\r\nfunction shallowClone(obj) {\r\n    return clone(obj, \"shallow\");\r\n}\r\n/** 深克隆，深克隆主要的点在于，复制Object或Array实例的每一个属性，基本类型和特殊构造器类型*/\r\nfunction deepClone(obj) {\r\n    return clone(obj, \"deep\");\r\n}\r\nfunction isObject(value) {\r\n    return value !== null && typeof value === \"object\";\r\n}\r\n/** 判断值，使用深比较 */\r\nfunction hasChanged(value, oldValue) {\r\n    return !isSameDeep(value, oldValue);\r\n}\r\n/** 单例模式 */\r\nfunction getSingle(fn) {\r\n    var res;\r\n    return function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        return res || (res = fn.apply(this, args));\r\n    };\r\n}\n\nvar EventCenter = {\r\n    subscribeList: {},\r\n    // 储存已发布未订阅的消息\r\n    pubAndNoSub: {},\r\n    subscribe: function (name, fn) {\r\n        var _a;\r\n        if (this.pubAndNoSub[name]) {\r\n            fn(this.pubAndNoSub[name]);\r\n            Reflect.deleteProperty(this.pubAndNoSub, name);\r\n        }\r\n        ((_a = this.subscribeList[name]) === null || _a === void 0 ? void 0 : _a.push(fn)) || (this.subscribeList[name] = [fn]);\r\n    },\r\n    publish: function (name, value) {\r\n        var fns = this.subscribeList[name];\r\n        if (!fns || fns.length === 0) {\r\n            this.pubAndNoSub[name] = value;\r\n        }\r\n        else {\r\n            fns.forEach(function (fn) { return fn(value); });\r\n        }\r\n    },\r\n    remove: function (name, fn) {\r\n        var _this = this;\r\n        var fns = this.subscribeList[name];\r\n        if (!fns || fns.length === 0)\r\n            return;\r\n        if (fn) {\r\n            fns.forEach(function (_fn, index) {\r\n                if (_fn === fn) {\r\n                    _this.subscribeList[name].splice(index, 1);\r\n                }\r\n            });\r\n        }\r\n        else {\r\n            this.subscribeList[name] = [];\r\n        }\r\n    },\r\n};\r\n/** 给对象添加发布订阅的事件中心 */\r\nfunction installEventCenter(obj) {\r\n    var cloneObj = deepClone(EventCenter);\r\n    for (var k in EventCenter)\r\n        obj[k] = cloneObj[k];\r\n    return obj;\r\n}\n\n/** 解析省市区列表数据，提供给uView组件使用 */\r\nfunction parseAreaListData(areaData) {\r\n    var temp = [];\r\n    var province_list = areaData.province_list, city_list = areaData.city_list, county_list = areaData.county_list;\r\n    for (var provinceCode in province_list) {\r\n        var provinceId = provinceCode.substr(0, 2);\r\n        var provinceItem = {};\r\n        provinceItem.value = province_list[provinceCode];\r\n        provinceItem.label = province_list[provinceCode];\r\n        for (var cityCode in city_list) {\r\n            var cityId = cityCode.substr(0, 4);\r\n            var cityItem = {};\r\n            if (cityId.includes(provinceId)) {\r\n                cityItem.value = city_list[cityCode];\r\n                cityItem.label = city_list[cityCode];\r\n                for (var countyCode in county_list) {\r\n                    var countyItem = {};\r\n                    if (countyCode.includes(cityId)) {\r\n                        countyItem.value = county_list[countyCode];\r\n                        countyItem.label = county_list[countyCode];\r\n                        cityItem.children.push(countyItem);\r\n                    }\r\n                }\r\n                provinceItem.children.push(cityItem);\r\n            }\r\n        }\r\n        temp.push(provinceItem);\r\n    }\r\n    return temp;\r\n}\n\n/**\r\n * @description 防抖，防止抖动，将一段时间内的多次触发控制为一次触发\r\n * @param fn 回调函数\r\n * @param delay 延迟时间\r\n * @param immediate 是否立即调用\r\n */\r\nfunction debounce(fn, delay, immediate) {\r\n    if (delay === void 0) { delay = 1500; }\r\n    if (immediate === void 0) { immediate = true; }\r\n    var timer;\r\n    return function () {\r\n        var _this = this;\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        if (timer)\r\n            clearTimeout(timer);\r\n        if (immediate) {\r\n            if (!timer)\r\n                fn.apply(this, args);\r\n            timer = setTimeout(function () { return (timer = null); }, delay);\r\n        }\r\n        else {\r\n            timer = setTimeout(function () { return fn.apply(_this, args); }, delay);\r\n        }\r\n    };\r\n}\r\n/**\r\n * @description 节流，将一段时间内的多次触发控制为一定时间间隔内触发一次\r\n * @param fn 回调函数\r\n * @param delay 延迟时间\r\n * @param immediate 是否立即调用\r\n */\r\nfunction throttle(fn, delay, type) {\r\n    if (delay === void 0) { delay = 1500; }\r\n    if (type === void 0) { type = \"timestamp\"; }\r\n    if (type === \"timestamp\") {\r\n        var prevTime_1 = 0;\r\n        return function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            var currentTime = Date.now();\r\n            if (currentTime - prevTime_1 > delay) {\r\n                fn.apply(this, args);\r\n                prevTime_1 = currentTime;\r\n            }\r\n        };\r\n    }\r\n    else {\r\n        var timer_1;\r\n        return function () {\r\n            var _this = this;\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            if (!timer_1) {\r\n                timer_1 = setTimeout(function () {\r\n                    fn.apply(_this, args);\r\n                    timer_1 = null;\r\n                }, delay);\r\n            }\r\n        };\r\n    }\r\n}\n\nexports.clone = clone;\nexports.compare = compare;\nexports.debounce = debounce;\nexports.deepClone = deepClone;\nexports.get = get;\nexports.getSingle = getSingle;\nexports.getType = getType;\nexports.hasChanged = hasChanged;\nexports.installEventCenter = installEventCenter;\nexports.isObject = isObject;\nexports.isSameDeep = isSameDeep;\nexports.isSameShallow = isSameShallow;\nexports.parseAreaListData = parseAreaListData;\nexports.shallowClone = shallowClone;\nexports.throttle = throttle;\n","export const setTip = (function () {\r\n  setTimeout(() => {\r\n    function tip(text: string) {\r\n      console.error(\r\n        `必须在 app.js|ts 文件 调用 ${text}()，参考：https://www.npmjs.com/package/@savage181855/mini-store`\r\n      );\r\n    }\r\n    if (!types.isProxyPage) tip(\"proxyPage\");\r\n    if (!types.isProxyComponent) tip(\"proxyComponent\");\r\n    if (!types.isProxyApp) tip(\"proxyApp\");\r\n  });\r\n\r\n\r\n  const types = {\r\n    isProxyPage: false,\r\n    isProxyComponent: false,\r\n    isProxyApp: false,\r\n  }\r\n\r\n  return function (text: keyof typeof types) {\r\n    types[text] = true;\r\n  };\r\n})();\r\n\r\n","export function getCurrentPagePath() {\r\n  const pages = getCurrentPages();\r\n  return pages[pages.length - 1]?.route || '';\r\n}","import type {\r\n  Callback,\r\n  DepStateWithWatch,\r\n  DepStack,\r\n  ComponentInstance,\r\n} from \"./types\";\r\n\r\nimport { deepClone, isSameDeep } from \"@savage181855/utils\";\r\n\r\nimport { getCurrentPagePath } from \"./utils\";\r\nexport class Dep extends Map<any, Set<Callback>> {\r\n  static stores: Record<string, DepStateWithWatch> = {};\r\n  static stack: DepStack = [];\r\n}\r\n\r\n// not pure function\r\nexport function updateStoreState() {\r\n  const path = getCurrentPagePath();\r\n  if (!path) return;\r\n\r\n  const stores = Dep.stores[path];\r\n  if (!stores) return;\r\n\r\n  stores.forEach((s) => {\r\n    const { mapState, instance, store, watch, mapComputed } = s;\r\n\r\n    const stateArr = [];\r\n\r\n    if (mapState) stateArr.push(...mapState);\r\n    if (mapComputed) stateArr.push(...mapComputed);\r\n    const data: Record<string, any> = {};\r\n    stateArr?.forEach((key) => {\r\n      if (\r\n        !isSameDeep(\r\n          instance.data[key as keyof typeof instance.data] as any,\r\n          store[key]\r\n        )\r\n      ) {\r\n        data[key] = deepClone(store[key]);\r\n      }\r\n    });\r\n    if (JSON.stringify(data) !== \"{}\") instance.setData(data);\r\n\r\n    if (watch) {\r\n      Object.keys(watch).forEach((key) => {\r\n        if (!isSameDeep(instance.watchValue[key], store[key])) {\r\n          const newValue = deepClone(store[key]);\r\n          watch[key] = watch[key].bind(instance);\r\n          watch[key](instance.watchValue[key], newValue);\r\n          instance.watchValue[key] = newValue;\r\n        }\r\n      });\r\n    }\r\n  });\r\n}\r\n\r\nexport function clearStoreDep() {\r\n  const path = getCurrentPagePath();\r\n  Dep.stores[path] = [];\r\n}\r\n\r\n// not pure function\r\nexport function removeStoreDep(instance: ComponentInstance) {\r\n  const path = getCurrentPagePath();\r\n  Dep.stores[path] = Dep.stores[path].filter(\r\n    (item) => item.instance !== instance\r\n  );\r\n}\r\n","import { deepClone } from \"@savage181855/utils\";\r\n\r\nimport type {\r\n  BaseStoreOptions,\r\n  AppOptions,\r\n  AppNewOptions,\r\n  PageOptions,\r\n  PageNewOptions,\r\n  ComponentOptions,\r\n  ComponentNewOptions,\r\n  StoreOptions,\r\n  ComponentInstance,\r\n  Instance,\r\n} from \"./types\";\r\n\r\nimport { setTip } from \"./tips\";\r\n\r\nimport { updateStoreState, clearStoreDep, removeStoreDep } from \"./dep\";\r\n\r\nimport { getCurrentPagePath } from \"./utils\";\r\n\r\nfunction callUseStoreRef(\r\n  instance: Instance,\r\n  stores?: BaseStoreOptions | StoreOptions\r\n) {\r\n  stores?.forEach((s) => {\r\n    const { useStoreRef, ...rest } = s;\r\n    useStoreRef(instance, rest);\r\n  });\r\n}\r\n\r\nexport function proxyApp() {\r\n  setTip(\"isProxyApp\");\r\n\r\n  const originApp = App;\r\n\r\n  App = function (options: AppNewOptions) {\r\n    const { stores, ...rest } = options;\r\n    const newOptions = {\r\n      ...rest,\r\n      onLaunch(o: WechatMiniprogram.App.LaunchShowOption) {\r\n        this.type = \"app\";\r\n        const { stores } = options;\r\n        callUseStoreRef(this as any as Instance, stores);\r\n\r\n        options?.onLaunch?.call(this, o);\r\n      },\r\n    } as AppOptions;\r\n\r\n    return originApp(newOptions);\r\n  };\r\n}\r\n\r\nexport function proxyPage(globalOptions: PageOptions = {}) {\r\n  setTip(\"isProxyPage\");\r\n\r\n  const OriginPage = Page;\r\n  Page = function (options: PageNewOptions) {\r\n    const { stores, ...rest } = options;\r\n    let newOptions: PageOptions = {\r\n      ...globalOptions,\r\n      ...rest,\r\n      onLoad(o) {\r\n        const { stores } = options;\r\n        callUseStoreRef(this as any as Instance, stores);\r\n\r\n        globalOptions?.onLoad?.call(this, o);\r\n        options?.onLoad?.call(this, o);\r\n      },\r\n      onShow() {\r\n        updateStoreState();\r\n\r\n        globalOptions?.onShow?.call(this);\r\n        options?.onShow?.call(this);\r\n      },\r\n      onUnload() {\r\n        clearStoreDep();\r\n        globalOptions?.onUnload?.call(this);\r\n        options?.onUnload?.call(this);\r\n      },\r\n    };\r\n\r\n    const hooks = [\r\n      \"onReady\",\r\n      \"onHide\",\r\n      \"onPullDownRefresh\",\r\n      \"onReachBottom\",\r\n      \"onPageScroll\",\r\n      \"onResize\",\r\n      \"onTabItemTap\",\r\n    ];\r\n    newOptions = mixinHooks(hooks, newOptions, globalOptions, options);\r\n\r\n    return OriginPage(newOptions);\r\n  };\r\n}\r\n\r\nexport function proxyComponent(globalOptions: ComponentOptions = {}) {\r\n  setTip(\"isProxyComponent\");\r\n\r\n  const OriginComponent = Component;\r\n  Component = function (options: ComponentNewOptions) {\r\n    const { stores, ...rest } = options;\r\n\r\n    let newOptions: ComponentOptions = {\r\n      ...globalOptions,\r\n      ...rest,\r\n      attached() {\r\n        this.route = getCurrentPagePath();\r\n        const { stores } = options;\r\n        callUseStoreRef(this as any as Instance, stores);\r\n\r\n        updateStoreState();\r\n\r\n        options?.attached?.call(this);\r\n        globalOptions?.attached?.call(this);\r\n      },\r\n      detached() {\r\n        removeStoreDep(this as any as ComponentInstance);\r\n\r\n        options?.detached?.call(this);\r\n        globalOptions?.detached?.call(this);\r\n      },\r\n      lifetimes: {\r\n        attached() {\r\n          this.route = getCurrentPagePath();\r\n          const { stores } = options;\r\n\r\n          callUseStoreRef(this as any as Instance, stores);\r\n\r\n          updateStoreState();\r\n\r\n          options?.lifetimes?.attached?.call(this);\r\n          globalOptions?.lifetimes?.attached?.call(this);\r\n        },\r\n        detached() {\r\n          removeStoreDep(this as any as ComponentInstance);\r\n\r\n          options?.lifetimes?.detached?.call(this);\r\n          globalOptions?.lifetimes?.detached?.call(this);\r\n        },\r\n      },\r\n    };\r\n\r\n    const hooks = [\r\n      \"created\",\r\n      \"ready\",\r\n      \"moved\",\r\n      \"error\",\r\n      \"lifetimes.created\",\r\n      \"lifetimes.ready\",\r\n      \"lifetimes.moved\",\r\n      \"lifetimes.error\",\r\n      \"pageLifetimes.show\",\r\n      \"pageLifetimes.hide\",\r\n      \"pageLifetimes.resize\",\r\n    ];\r\n    newOptions = mixinHooks(hooks, newOptions, globalOptions, options);\r\n\r\n    return OriginComponent(newOptions);\r\n  };\r\n}\r\n\r\ntype BaseOptions = Record<string, any>;\r\n\r\n/** 全局混入hook */\r\nfunction mixinHooks(\r\n  hooks: string[],\r\n  newOptions: BaseOptions,\r\n  globalOptions: BaseOptions,\r\n  options: BaseOptions\r\n) {\r\n  const newO = deepClone(newOptions);\r\n\r\n  hooks.forEach((name) => {\r\n    // 这里分割的原因是要注入 lifetimes.created 这种 hook\r\n    const paths = name.split(\".\");\r\n    const len = paths.length;\r\n\r\n    const indexOne = paths[0];\r\n    if (len === 1) {\r\n      newO[indexOne] = function () {\r\n        globalOptions?.[indexOne]?.call(this, ...Array.from(arguments));\r\n        options?.[indexOne]?.call(this, ...Array.from(arguments));\r\n      };\r\n    } else {\r\n      const indexTwo = paths[1];\r\n      // pageLifetimes 的生命周期会覆盖this上的生命周期\r\n      if (\r\n        globalOptions?.[indexOne]?.[indexTwo] ||\r\n        options?.[indexOne]?.[indexTwo]\r\n      ) {\r\n        newO[indexOne][indexTwo] = function () {\r\n          globalOptions?.[indexOne]?.[indexTwo]?.call(this, ...Array.from(arguments));\r\n          options?.[indexOne]?.[indexTwo]?.call(this, ...Array.from(arguments));\r\n        };\r\n      }\r\n    }\r\n  });\r\n\r\n  return newO;\r\n}\r\n","import {\r\n  isObject,\r\n  deepClone,\r\n  hasChanged,\r\n} from \"@savage181855/utils\";\r\n\r\nimport type {\r\n  StateType,\r\n  Callback,\r\n  Options,\r\n} from \"./types\";\r\n\r\nimport { Dep, updateStoreState } from \"./dep\";\r\n\r\n// not pure function\r\nfunction createReactive<T extends object>(target: T): T {\r\n  const deps = new Dep();\r\n\r\n  const obj = new Proxy(target, {\r\n    get(target, key: string, receiver) {\r\n      const res = Reflect.get(target, key, receiver);\r\n      if (Dep.stack.length > 0) {\r\n        if (!deps.get(key)) deps.set(key, new Set<Callback>());\r\n\r\n        Dep.stack.forEach((item) => {\r\n          deps.get(key)?.add(item);\r\n        });\r\n      }\r\n      return res;\r\n    },\r\n    set(target, key: string, value, receiver) {\r\n      const oldV = deepClone((target as any)[key]);\r\n      const res = Reflect.set(target, key, value, receiver);\r\n      if (hasChanged(oldV, value)) {\r\n        deps.get(key)?.forEach((item) => item(oldV, value));\r\n      }\r\n      updateStoreState();\r\n      return res;\r\n    },\r\n  });\r\n\r\n  for (let k in obj) {\r\n    const child = obj[k];\r\n    if (isObject(child)) {\r\n      obj[k] = createReactive(obj[k] as any) as any;\r\n    }\r\n  }\r\n\r\n  return obj;\r\n}\r\n\r\n// not pure function\r\nfunction setupActions(plainStore: StateType, proxyStore: StateType) {\r\n  for (let k in plainStore) {\r\n    if (typeof plainStore[k] === \"function\") {\r\n      plainStore[k] = (plainStore[k] as Function).bind(proxyStore, proxyStore);\r\n    }\r\n  }\r\n}\r\n\r\n// not pure function\r\nfunction setupPatchOfStore(plainStore: StateType, proxyStore: StateType) {\r\n  plainStore.patch = function (val: StateType | Callback) {\r\n    if (typeof val === \"object\") {\r\n      for (let k in val) {\r\n        proxyStore[k] = (val as any)[k];\r\n      }\r\n    }\r\n\r\n    if (typeof val === \"function\") {\r\n      val(proxyStore);\r\n    }\r\n  };\r\n}\r\n\r\n// not pure function\r\nfunction setupComputed(fns: Record<string, Callback>, proxyStore: StateType) {\r\n  if (fns) {\r\n    for (let k in fns) {\r\n      fns[k] = fns[k].bind(proxyStore, proxyStore);\r\n      Dep.stack.push(() => ((proxyStore as any)[k] = fns[k]()));\r\n      (proxyStore as any)[k] = fns[k]();\r\n      Dep.stack.pop();\r\n    }\r\n  }\r\n}\r\n\r\nexport function createStore<\r\n  S extends StateType,\r\n  A extends Record<string, Callback>,\r\n  C = {}\r\n>(options: Options<S, A, C>) {\r\n  const plainStore = {\r\n    ...options.state,\r\n    ...options.actions,\r\n    ...options.computed,\r\n  };\r\n\r\n  const store = createReactive(plainStore);\r\n  setupActions(plainStore, store);\r\n  setupPatchOfStore(plainStore, store);\r\n  setupComputed(options.computed as any, store);\r\n\r\n  return store;\r\n}\r\n","import { deepClone } from \"@savage181855/utils\";\r\n\r\nimport type {\r\n  BaseStoreOptionItem,\r\n  StateType,\r\n  Callback,\r\n  Options,\r\n  StoreOptionItem,\r\n  Instance,\r\n  PageInstance,\r\n  ComponentInstance,\r\n  Store,\r\n} from \"./types\";\r\n\r\nimport { Dep } from \"./dep\";\r\n\r\nimport { createStore } from \"./createStore\";\r\n\r\nexport function defineStore<\r\n  S extends StateType,\r\n  A extends Record<string, Callback>,\r\n  C = {}\r\n>(options: Options<S, A, C>) {\r\n  const state = options.state;\r\n  const computed = options.computed as any as Record<string, Callback>;\r\n  const actions = options.actions as any as Record<string, Callback>;\r\n\r\n  const store = createStore(options);\r\n\r\n  function useStore(\r\n    instance: Instance,\r\n    options: BaseStoreOptionItem | StoreOptionItem\r\n  ): void;\r\n\r\n  function useStore(): Store<S, A, C>;\r\n\r\n  function useStore(\r\n    instance?: Instance,\r\n    options?: BaseStoreOptionItem | StoreOptionItem\r\n  ) {\r\n\r\n    if (instance && options) {\r\n      instance[options.storeKey as keyof typeof instance] = store;\r\n      if (instance.type === \"app\") return;\r\n      // ;debugger;\r\n      const o = options as StoreOptionItem;\r\n\r\n      const stateKeys = Object.keys(state);\r\n      if (o.mapState) {\r\n        o.mapState.forEach((key) => {\r\n          if (!stateKeys.includes(key)) {\r\n            console.error(\r\n              `msg: mapState \"${key}\" not in ${o.storeKey};\\n\\n` +\r\n                `info: filePath: ${instance.is};`\r\n            );\r\n            return;\r\n          }\r\n        });\r\n      }\r\n\r\n      if (o.watch) {\r\n        // use to compare watch whether to execute\r\n        const watchValue: StateType = {};\r\n        Object.keys(o.watch).forEach((key) => {\r\n          if (!stateKeys.includes(key)) {\r\n            console.error(\r\n              `msg: watch \"${key}\" not in ${o.storeKey};\\n\\n` +\r\n                `info: filePath: ${instance.is};`\r\n            );\r\n            return;\r\n          }\r\n          watchValue[key] = deepClone(store[key]);\r\n        });\r\n        instance.watchValue = {\r\n          ...(instance.watchValue as any),\r\n          ...watchValue,\r\n        };\r\n      }\r\n\r\n      if (o.mapComputed) {\r\n        // use to compare computed function whether to execute\r\n        const computedKeys = Object.keys(computed);\r\n        o.mapComputed.forEach((key) => {\r\n          if (!computedKeys.includes(key)) {\r\n            console.error(\r\n              `msg: mapComputed \"${key}\" not in ${o.storeKey};\\n\\n` +\r\n                `info: filePath: ${instance.is};`\r\n            );\r\n            return;\r\n          }\r\n        });\r\n      }\r\n\r\n      if (o.mapActions) {\r\n        // use to compare computed function whether to execute\r\n        const actionKeys = Object.keys(actions);\r\n        o.mapActions.forEach((key) => {\r\n          if (!actionKeys.includes(key)) {\r\n            console.error(\r\n              `msg: mapActions \"${key}\" not in ${o.storeKey};\\n\\n` +\r\n                `info: filePath: ${instance.is};`\r\n            );\r\n            return;\r\n          }\r\n          instance[key] = store[key];\r\n        });\r\n      }\r\n\r\n      const route = instance.route as keyof typeof instance as string;\r\n\r\n      Dep.stores[route] = Dep.stores[route] || [];\r\n\r\n      const isExist = Dep.stores[route].some((v) => {\r\n        return v.instance === instance && v.store === store;\r\n      });\r\n\r\n      if (!isExist) {\r\n        Dep.stores[route].push({\r\n          ...o,\r\n          instance: instance as PageInstance | ComponentInstance,\r\n          store,\r\n        });\r\n      }\r\n    } else {\r\n      return store;\r\n    }\r\n  }\r\n  return useStore;\r\n}\r\n"],"names":["isSameDeep","deepClone","hasChanged","isObject"],"mappings":"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"}